---
title: Selective Disclosure for Holders
sidebar:
  label: Selective Disclosure for Holders
  order: 3
---

The **holder** receives the issuer-signed JWT together with every disclosure. Their job is to choose a subset of disclosures that match a verifier’s request.

## Navigating disclosures

`SdJwtHolder` exposes two convenience methods:

- `availableDisclosurePaths()` returns canonical paths such as `family_name` or `address.locality`.
- `buildPresentation()` accepts either `null` (send nothing selectively) or a list of paths that should be revealed.

```php
use Nyra\SdJwt\Holder\SdJwtHolder;

$holder = new SdJwtHolder($issued);

// Inspect the credential
foreach ($holder->availableDisclosurePaths() as $path) {
    echo "• {$path}\n";
}

// Reveal only the last name and nationality
$presentation = $holder->buildPresentation([
    'family_name',
    'nationalities[1]',
]);

$compact = $presentation->toCompact();
```

`toCompact()` serialises the SD-JWT presentation according to Section 4 of the draft: `<issuer-signed JWT>~<disclosure 1>~...~<disclosure N>~`.

## Adding key binding

When a verifier requests proof-of-possession, pass `KeyBindingOptions` and a JWT signer that represents the holder’s private key.

```php
use Nyra\SdJwt\Holder\KeyBindingOptions;
use Nyra\SdJwt\Jwt\FirebaseJwtSigner;

$options = new KeyBindingOptions(
    audience: 'https://verifier.example',
    nonce: 'random-nonce',
);

$presentationWithKb = $holder->buildPresentation(
    paths: ['family_name'],
    keyBindingOptions: $options,
    keyBindingSigner: new FirebaseJwtSigner('holder-key', 'HS256')
);
```

The holder signer produces a **Key Binding JWT** (kb+jwt) whose `sd_hash` claim hashes the exact SD-JWT string. The library automatically orders disclosures by path depth to satisfy Section 4.3.1.

## When to keep disclosures hidden

- If a verifier does not request proof of a claim, omit its path.
- Never include the salt or raw disclosure string outside of this library.
- `SdJwtHolder` prevents duplicate disclosures and validates that the requested paths exist.

Continue with the verifier chapter to see how `sd_hash`, audiences, and nonces are checked.

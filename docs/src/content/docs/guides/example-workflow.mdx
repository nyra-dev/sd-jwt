---
title: End-to-End Example
sidebar:
  label: End-to-End Example
  order: 6
---

This chapter reprises everything you learned and runs the issuer, holder, and verifier inside one script. Copy it into a blank PHP file and adjust secrets to your needs.

```php
<?php

require __DIR__ . '/vendor/autoload.php';

use Nyra\SdJwt\Claim\SdClaim;
use Nyra\SdJwt\Issuer\IssuerOptions;
use Nyra\SdJwt\Issuer\SdJwtIssuer;
use Nyra\SdJwt\Jwt\FirebaseJwtSigner;
use Nyra\SdJwt\Holder\KeyBindingOptions;
use Nyra\SdJwt\Holder\SdJwtHolder;
use Nyra\SdJwt\Jwt\FirebaseJwtVerifier;
use Nyra\SdJwt\Verification\SdJwtVerifier;
use Nyra\SdJwt\Verification\VerifierOptions;
use Nyra\SdJwt\Support\JwkConverter;
use Firebase\JWT\Key;

// --- Issuer ---------------------------------------------------------------
$issuerSigner = new FirebaseJwtSigner('issuer-secret', 'HS256');
$issuer = new SdJwtIssuer($issuerSigner);

$claims = [
    'iss' => 'https://university.example',
    'sub' => 'student-42',
    'given_name' => 'River',
    'family_name' => SdClaim::disclose('Sato'),
    'enrollment_status' => SdClaim::disclose('Full-time'),
    'nationalities' => ['US', SdClaim::disclose('JP')],
    'cnf' => [
        'jwk' => [
            'kty' => 'EC',
            'crv' => 'P-256',
            'x' => 'TCAER19Zvu3OHF4j4W4vfSVoHIP1ILilDls7vCeGemc',
            'y' => 'ZxjiWWbZMQGHVWKVQ4hbSIirsVfuecCE6t4jT9F2HZQ',
        ],
    ],
];

$issued = $issuer->issue($claims, new IssuerOptions(headers: ['typ' => 'vc+sd-jwt']));

// --- Holder --------------------------------------------------------------
$holder = new SdJwtHolder($issued);

$presentation = $holder->buildPresentation(
    paths: ['family_name', 'enrollment_status'],
    keyBindingOptions: new KeyBindingOptions(
        audience: 'https://verifier.example',
        nonce: 'job-fair-2025',
    ),
    keyBindingSigner: new FirebaseJwtSigner('holder-private-key', 'ES256')
);

// --- Verifier ------------------------------------------------------------
$verifier = new SdJwtVerifier(new FirebaseJwtVerifier(new Key('issuer-secret', 'HS256')));

$options = new VerifierOptions(
    requireKeyBinding: true,
    expectedAudience: 'https://verifier.example',
    expectedNonce: 'job-fair-2025',
    currentTime: time(),
    keyBindingKey: JwkConverter::toKey($claims['cnf']['jwk'], 'ES256'),
);

$result = $verifier->verify($presentation->toCompact(), $options);

print_r([
    'payload' => $result->payload(),
    'disclosures' => $result->disclosures(),
]);
```

### Output

```
Array
(
    [payload] => Array
        (
            [iss] => https://university.example
            [sub] => student-42
            [given_name] => River
            [family_name] => Sato
            [enrollment_status] => Full-time
            [nationalities] => Array
                (
                    [0] => US
                    [1] => JP
                )

            [cnf] => Array
                (
                    [jwk] => Array
                        (
                            [kty] => EC
                            [crv] => P-256
                            [x] => TCAER19Zvu3OHF4j4W4vfSVoHIP1ILilDls7vCeGemc
                            [y] => ZxjiWWbZMQGHVWKVQ4hbSIirsVfuecCE6t4jT9F2HZQ
                        )

                )

        )

    [disclosures] => Array
        (
            [0] => WyI... (base64url disclosure strings)
        )
)
```

You now have a credential lifecycle that respects selective disclosure, optional key binding, and the verification rules defined in the IETF draft. Adapt the scripts to your framework (Laravel, Symfony, Slim, etc.) by injecting the corresponding issuer, holder, or verifier services.
